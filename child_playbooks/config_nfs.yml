---
 - name: Configuring nfs 
   hosts: server
   vars_files: 
      - /root/ansible/variable.yml
   
   tasks: 
       - name: ensure shared directory is present on nfs-server
         file:
            path: "{{ shared_dir }}"
            owner: root
            mode: '0755'
            state: directory

       - name: configuring /etc/exports.d/share.exports on nfs-server
         template:
            src: /root/share.exports.j2
            dest: /etc/exports.d/share.exports
            owner: root
            group: root
            mode: '0644'
         notify: reload exports

       - name: the nfs-server service is started and enabled
         service: 
            name: nfs-server
            state: started
            enabled: yes

   handlers:
      - name: reload exports
        service: 
           name: nfs-server
           state: reloaded 
